// Generated by CoffeeScript 1.6.3
(function() {
  $(function() {
    var $room, $users, action, dataSource, socket;
    dataSource = $('#users-template').html();
    socket = io.connect();
    $room = $('#room');
    $users = $('#users');
    action = function(data, action) {
      var userId, userList, userName;
      $users.empty();
      $room.append('<div>' + data.id + ' has ' + action + ' the room</div>');
      userList = (function() {
        var _ref, _results;
        _ref = data.users;
        _results = [];
        for (userId in _ref) {
          userName = _ref[userId];
          _results.push($users.append("<div class='user' data-id='" + userId + "'>" + userName + "</div><hr>"));
        }
        return _results;
      })();
    };
    socket.on('messageDisplay', function(data) {
      $room.append('<div class="messageId">' + data.id + ': <span class="message">' + data.message + '</span></div>');
    });
    socket.on('connected', function(data) {
      action(data, 'entered');
    });
    socket.on('userDisconnect', function(data) {
      action(data, 'left');
    });
    $('#message-input').on('keyup', function(e) {
      if (e.which === 13) {
        socket.emit('chatMessage', $(this).val());
        $(this).val('');
      }
    });
  });

}).call(this);
